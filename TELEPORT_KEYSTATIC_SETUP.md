# üöÄ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Keystatic –∑ Teleport

> **–ú–µ—Ç–∞:** –ó–∞–ø—É—Å—Ç–∏—Ç–∏ Astro + Keystatic –Ω–∞ –æ—Ñ—ñ—Å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ –∑ –¥–æ—Å—Ç—É–ø–æ–º —á–µ—Ä–µ–∑ Teleport

---

## üìã –ó–º—ñ—Å—Ç

1. [–û–≥–ª—è–¥ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏](#–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞)
2. [–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞](#–ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞)
3. [–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Astro](#–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è-astro)
4. [–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Teleport](#–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è-teleport)
5. [–†–æ–±–æ—Ç–∞ –∑ Keystatic](#—Ä–æ–±–æ—Ç–∞-–∑-keystatic)
6. [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è](#–∞–≤—Ç–æ–º–∞—Ç—ñ–∑–∞—Ü—ñ—è)
7. [–ë–µ–∑–ø–µ–∫–∞](#–±–µ–∑–ø–µ–∫–∞)
8. [Troubleshooting](#troubleshooting)

---

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ {#–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞}

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ó–æ–≤–Ω—ñ—à–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ                               ‚îÇ
‚îÇ  (–¥–∏–∑–∞–π–Ω–µ—Ä, –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä)                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚îÇ HTTPS —á–µ—Ä–µ–∑ Teleport
                   ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Teleport Proxy                                     ‚îÇ
‚îÇ  (teleport.your-company.com)                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚îÇ –ü—Ä–æ–∫—Å—É–≤–∞–Ω–Ω—è –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —Å–µ—Ä–≤–µ—Ä
                   ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –û—Ñ—ñ—Å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä (192.168.x.x)                       ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Astro Dev Server                            ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Port: 4321                                  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ http://localhost:4321/keystatic (CMS)   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ http://localhost:4321/ (preview)        ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Git Repository (–ª–æ–∫–∞–ª—å–Ω–∏–π)                  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  /var/www/three-holy-hierarchs               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ src/content/posts/*.md                   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ src/content/sermons/*.md                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ src/content/saints/*.md                  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚îÇ git push
                   ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  GitHub                                             ‚îÇ
‚îÇ  artemius-info/three-holy-hierarchs-church          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚îÇ Webhook –Ω–∞ –¥–µ–ø–ª–æ–π
                   ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Vercel                                             ‚îÇ
‚îÇ  https://three-holy-hierarchs-church.vercel.app     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üñ•Ô∏è –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ {#–ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞}

### –ö—Ä–æ–∫ 1: –°–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–º–æ–≥–∏

**–ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ:**
- **OS:** Ubuntu 20.04+ / Debian 11+ / CentOS 8+
- **CPU:** 2 cores
- **RAM:** 2 GB
- **Disk:** 10 GB –≤—ñ–ª—å–Ω–æ–≥–æ –º—ñ—Å—Ü—è
- **Node.js:** v18+ –∞–±–æ v20+

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–µ—Ä—Å—ñ—é Node.js
node --version  # –ú–∞—î –±—É—Ç–∏ v18.x –∞–±–æ v20.x

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ npm
npm --version

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Git
git --version
```

### –ö—Ä–æ–∫ 2: –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Node.js (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)

**–î–ª—è Ubuntu/Debian:**
```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Node.js 20.x LTS
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ build tools
sudo apt-get install -y build-essential
```

**–î–ª—è CentOS/RHEL:**
```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Node.js 20.x LTS
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -
sudo yum install -y nodejs

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ build tools
sudo yum groupinstall -y "Development Tools"
```

### –ö—Ä–æ–∫ 3: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –∑–∞–ø—É—Å–∫—É

```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
sudo useradd -m -s /bin/bash astro-app
sudo usermod -aG sudo astro-app  # –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ sudo –ø—Ä–∞–≤–∞

# –ü–µ—Ä–µ–π—Ç–∏ –ø—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
sudo su - astro-app
```

### –ö—Ä–æ–∫ 4: –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
# –ü–µ—Ä–µ–π—Ç–∏ —É –¥–æ–º–∞—à–Ω—é –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é
cd ~

# –°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –¥–ª—è –ø—Ä–æ–µ–∫—Ç—É
mkdir -p /home/astro-app/projects
cd /home/astro-app/projects

# –ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
git clone https://github.com/artemius-info/three-holy-hierarchs-church.git
cd three-holy-hierarchs-church

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
npm install
```

### –ö—Ä–æ–∫ 5: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SSH –∫–ª—é—á—ñ–≤ –¥–ª—è Git

```bash
# –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ SSH –∫–ª—é—á (—è–∫—â–æ –Ω–µ–º–∞—î)
ssh-keygen -t ed25519 -C "server@your-company.com"

# –ü–æ–∫–∞–∑–∞—Ç–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á
cat ~/.ssh/id_ed25519.pub

# –î–æ–¥–∞–π—Ç–µ —Ü–µ–π –∫–ª—é—á —É GitHub:
# https://github.com/settings/keys
```

### –ö—Ä–æ–∫ 6: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Git

```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —ñ–º'—è —Ç–∞ email
git config --global user.name "Keystatic Server"
git config --global user.email "keystatic@your-company.com"

# –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–ø—É—à –Ω–∞ main
git config --global push.default simple
```

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Astro {#–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è-astro}

### –ö—Ä–æ–∫ 1: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É

**–†–µ–¥–∞–≥—É—î–º–æ package.json:**
```bash
nano package.json
```

**–î–æ–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è production:**
```json
{
  "scripts": {
    "dev": "astro dev",
    "dev:host": "astro dev --host 0.0.0.0",
    "dev:prod": "astro dev --host 0.0.0.0 --port 4321",
    "build": "astro build",
    "preview": "astro preview"
  }
}
```

### –ö—Ä–æ–∫ 2: –¢–µ—Å—Ç–æ–≤–∏–π –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ dev —Å–µ—Ä–≤–µ—Ä
npm run dev:host

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π
curl http://localhost:4321
```

**–Ø–∫—â–æ –≤—Å–µ –ø—Ä–∞—Ü—é—î:**
- ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω–∏–π
- ‚úÖ Keystatic –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ http://localhost:4321/keystatic

**–ó—É–ø–∏–Ω—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä:** `Ctrl+C`

### –ö—Ä–æ–∫ 3: –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è PM2 (Process Manager)

**PM2** - —É—Ç–∏–ª—ñ—Ç–∞ –¥–ª—è –∑–∞–ø—É—Å–∫—É Node.js –¥–æ–¥–∞—Ç–∫—ñ–≤ —è–∫ —Å–µ—Ä–≤—ñ—Å.

```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ PM2 –≥–ª–æ–±–∞–ª—å–Ω–æ
sudo npm install -g pm2

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
pm2 --version
```

### –ö—Ä–æ–∫ 4: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó PM2

**–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `ecosystem.config.js`:**
```bash
nano ~/projects/three-holy-hierarchs-church/ecosystem.config.js
```

**–í–º—ñ—Å—Ç —Ñ–∞–π–ª—É:**
```javascript
module.exports = {
  apps: [{
    name: 'keystatic-cms',
    script: 'npm',
    args: 'run dev:host',
    cwd: '/home/astro-app/projects/three-holy-hierarchs-church',
    instances: 1,
    autorestart: true,
    watch: false,
    max_memory_restart: '1G',
    env: {
      NODE_ENV: 'development',
      PORT: 4321,
      HOST: '0.0.0.0'
    },
    error_file: '/home/astro-app/logs/keystatic-error.log',
    out_file: '/home/astro-app/logs/keystatic-out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss Z'
  }]
};
```

**–°—Ç–≤–æ—Ä—ñ—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –¥–ª—è –ª–æ–≥—ñ–≤:**
```bash
mkdir -p ~/logs
```

### –ö—Ä–æ–∫ 5: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫
pm2 start ecosystem.config.js

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
pm2 status

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏
pm2 logs keystatic-cms

# –ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫—É
pm2 save

# –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞
pm2 startup
# –í–∏–∫–æ–Ω–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É, —è–∫—É –ø–æ–∫–∞–∂–µ PM2
```

**–ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ PM2:**
```bash
pm2 restart keystatic-cms    # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
pm2 stop keystatic-cms        # –ó—É–ø–∏–Ω–∏—Ç–∏
pm2 delete keystatic-cms      # –í–∏–¥–∞–ª–∏—Ç–∏ –∑ PM2
pm2 logs keystatic-cms        # –î–∏–≤–∏—Ç–∏—Å—è –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
pm2 monit                     # –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å—ñ–≤
```

---

## üîê –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Teleport {#–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è-teleport}

### –í–∞—Ä—ñ–∞–Ω—Ç –ê: Teleport Application Access

**–ù–∞–π–∫—Ä–∞—â–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤**

#### –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Application –≤ Teleport

**–£ Teleport Web UI:**

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É **Applications**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Add Application**
3. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–æ—Ä–º—É:

```yaml
Name: keystatic-cms
Description: Keystatic CMS –¥–ª—è —Ö—Ä–∞–º—É –¢—Ä—å–æ—Ö —Å–≤—è—Ç–∏—Ç–µ–ª—ñ–≤
URI: http://localhost:4321
Public Address: keystatic.teleport.your-company.com
```

4. **Labels** (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):
```yaml
env: production
team: web
project: three-holy-hierarchs
```

#### –ö—Ä–æ–∫ 2: –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Teleport Node

**–ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ –∑ Astro:**

```bash
# –°–∫–∞—á–∞—Ç–∏ Teleport
curl https://get.gravitational.com/teleport-v13.0.0-linux-amd64-bin.tar.gz | tar -xz

# –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –≤ /usr/local/bin
sudo mv teleport/teleport /usr/local/bin/
sudo mv teleport/tsh /usr/local/bin/

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
teleport version
```

#### –ö—Ä–æ–∫ 3: –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Teleport Node

**–°—Ç–≤–æ—Ä—ñ—Ç—å `/etc/teleport.yaml`:**

```yaml
version: v3
teleport:
  nodename: keystatic-server
  data_dir: /var/lib/teleport
  auth_token: YOUR_JOIN_TOKEN_FROM_TELEPORT_CLUSTER
  auth_servers:
    - teleport.your-company.com:443

app_service:
  enabled: yes
  apps:
  - name: keystatic-cms
    uri: http://localhost:4321
    public_addr: keystatic.teleport.your-company.com
    labels:
      env: production
      team: web
```

**–ó–∞–º—ñ–Ω—ñ—Ç—å:**
- `YOUR_JOIN_TOKEN_FROM_TELEPORT_CLUSTER` - —Ç–æ–∫–µ–Ω –∑ Teleport UI
- `teleport.your-company.com` - –≤–∞—à Teleport cluster –∞–¥—Ä–µ—Å

#### –ö—Ä–æ–∫ 4: –ó–∞–ø—É—Å–∫ Teleport Node

```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ systemd —Å–µ—Ä–≤—ñ—Å
sudo tee /etc/systemd/system/teleport.service > /dev/null <<EOF
[Unit]
Description=Teleport SSH Service
After=network.target

[Service]
Type=simple
Restart=on-failure
EnvironmentFile=-/etc/default/teleport
ExecStart=/usr/local/bin/teleport start --config=/etc/teleport.yaml
ExecReload=/bin/kill -HUP \$MAINPID
PIDFile=/run/teleport.pid
LimitNOFILE=524288

[Install]
WantedBy=multi-user.target
EOF

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å
sudo systemctl daemon-reload
sudo systemctl enable teleport
sudo systemctl start teleport

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
sudo systemctl status teleport
```

#### –ö—Ä–æ–∫ 5: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø—É

**–ó –≤–∞—à–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞:**

```bash
# –ê–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—è –≤ Teleport
tsh login --proxy=teleport.your-company.com

# –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–¥–∞—Ç–∫—É
tsh app login keystatic-cms

# –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
tsh app open keystatic-cms
```

**–ê–ë–û –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ:**
```
https://keystatic.teleport.your-company.com
```

---

### –í–∞—Ä—ñ–∞–Ω—Ç –ë: Teleport SSH Tunnel

**–ü—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø—É**

#### –ö—Ä–æ–∫ 1: SSH –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ Teleport

```bash
# –ó –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞
tsh login --proxy=teleport.your-company.com

# –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
tsh ssh astro-app@keystatic-server

# –°—Ç–≤–æ—Ä–∏—Ç–∏ SSH tunnel
tsh ssh -L 4321:localhost:4321 astro-app@keystatic-server
```

#### –ö—Ä–æ–∫ 2: –î–æ—Å—Ç—É–ø –¥–æ Keystatic

**–£ –±—Ä–∞—É–∑–µ—Ä—ñ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ:**
```
http://localhost:4321/keystatic
```

**–¶–µ –ø—Ä–æ–∫—Å—É—î –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ Teleport SSH tunnel.**

---

## üìù –†–æ–±–æ—Ç–∞ –∑ Keystatic {#—Ä–æ–±–æ—Ç–∞-–∑-keystatic}

### Workflow –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞

#### –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø

**–í–∞—Ä—ñ–∞–Ω—Ç –ê (—á–µ—Ä–µ–∑ Teleport App):**
```bash
# –ó –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞
tsh app login keystatic-cms
tsh app open keystatic-cms
```

**–í–∞—Ä—ñ–∞–Ω—Ç –ë (—á–µ—Ä–µ–∑ SSH tunnel):**
```bash
tsh ssh -L 4321:localhost:4321 astro-app@keystatic-server
# –í—ñ–¥–∫—Ä–∏—Ç–∏ http://localhost:4321/keystatic —É –±—Ä–∞—É–∑–µ—Ä—ñ
```

#### –ö—Ä–æ–∫ 2: –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç

1. –í—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è Keystatic CMS
2. –û–±–µ—Ä—ñ—Ç—å –∫–æ–ª–µ–∫—Ü—ñ—é (–ù–æ–≤–∏–Ω–∏, –ü—Ä–æ–ø–æ–≤—ñ–¥—ñ, –°–≤—è—Ç—ñ)
3. –°—Ç–≤–æ—Ä—ñ—Ç—å –∞–±–æ —Ä–µ–¥–∞–≥—É–π—Ç–µ –∑–∞–ø–∏—Å
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Save** - —Ñ–∞–π–ª –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ

#### –ö—Ä–æ–∫ 3: –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–∏

**–ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–µ—Ä–µ–∑ cron –∞–±–æ –≤—Ä—É—á–Ω—É):**

```bash
# –ü–µ—Ä–µ–π—Ç–∏ —É –ø—Ä–æ–µ–∫—Ç
cd /home/astro-app/projects/three-holy-hierarchs-church

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–º—ñ–Ω–∏
git status

# –î–æ–¥–∞—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏
git add src/content/

# –ó–∞–∫–æ–º—ñ—Ç–∏—Ç–∏
git commit -m "–û–Ω–æ–≤–ª–µ–Ω–æ –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ Keystatic"

# –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub
git push origin main
```

**Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–¥–µ–ø–ª–æ—ó—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é!**

---

## ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è {#–∞–≤—Ç–æ–º–∞—Ç—ñ–∑–∞—Ü—ñ—è}

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π git push –ø—ñ—Å–ª—è –∑–º—ñ–Ω

**–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–ø—É—à—É:**

```bash
nano ~/scripts/auto-push-content.sh
```

**–í–º—ñ—Å—Ç —Å–∫—Ä–∏–ø—Ç—É:**
```bash
#!/bin/bash

# –®–ª—è—Ö –¥–æ –ø—Ä–æ–µ–∫—Ç—É
PROJECT_DIR="/home/astro-app/projects/three-holy-hierarchs-church"

# –ü–µ—Ä–µ–π—Ç–∏ —É –ø—Ä–æ–µ–∫—Ç
cd "$PROJECT_DIR" || exit

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —î –∑–º—ñ–Ω–∏
if [[ -n $(git status -s src/content/) ]]; then
    echo "[$(date)] –í–∏—è–≤–ª–µ–Ω–æ –∑–º—ñ–Ω–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É. –ü—É—à–∏–º–æ –Ω–∞ GitHub..."

    # –î–æ–¥–∞—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏ —É content
    git add src/content/

    # –ó–∞–∫–æ–º—ñ—Ç–∏—Ç–∏ –∑ timestamp
    git commit -m "–ê–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É - $(date '+%Y-%m-%d %H:%M:%S')"

    # –ó–∞–ø—É—à–∏—Ç–∏ –Ω–∞ GitHub
    git push origin main

    echo "[$(date)] –ö–æ–Ω—Ç–µ–Ω—Ç —É—Å–ø—ñ—à–Ω–æ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ!"
else
    echo "[$(date)] –ù–µ–º–∞—î –∑–º—ñ–Ω —É –∫–æ–Ω—Ç–µ–Ω—Ç—ñ."
fi
```

**–ó—Ä–æ–±—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–º:**
```bash
chmod +x ~/scripts/auto-push-content.sh
```

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è cron –¥–ª—è –∞–≤—Ç–æ–ø—É—à—É

```bash
# –í—ñ–¥–∫—Ä–∏—Ç–∏ crontab
crontab -e

# –î–æ–¥–∞—Ç–∏ —Ä—è–¥–æ–∫ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω
*/5 * * * * /home/astro-app/scripts/auto-push-content.sh >> /home/astro-app/logs/auto-push.log 2>&1

# –ê–ë–û –∫–æ–∂–Ω—ñ 30 —Ö–≤–∏–ª–∏–Ω
*/30 * * * * /home/astro-app/scripts/auto-push-content.sh >> /home/astro-app/logs/auto-push.log 2>&1

# –ê–ë–û —Ä–∞–∑ –Ω–∞ –≥–æ–¥–∏–Ω—É
0 * * * * /home/astro-app/scripts/auto-push-content.sh >> /home/astro-app/logs/auto-push.log 2>&1
```

**–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏:**
```bash
tail -f ~/logs/auto-push.log
```

### Webhook –¥–ª—è –Ω–µ–≥–∞–π–Ω–æ–≥–æ –ø—É—à—É

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥: –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø—É—à—É –≤ UI**

**–°—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–æ—Å—Ç—É –≤–µ–±-—Ñ–æ—Ä–º—É:**

```bash
nano ~/projects/three-holy-hierarchs-church/public/admin/publish.html
```

```html
<!DOCTYPE html>
<html>
<head>
    <title>–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–∏</title>
    <style>
        body {
            font-family: Inter, sans-serif;
            max-width: 500px;
            margin: 100px auto;
            text-align: center;
        }
        button {
            padding: 16px 32px;
            font-size: 18px;
            background: #0070f3;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        button:hover { background: #0051cc; }
        .status { margin-top: 20px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç</h1>
    <p>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑–º—ñ–Ω –Ω–∞ GitHub</p>
    <button onclick="publish()">üöÄ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–∏</button>
    <div class="status" id="status"></div>

    <script>
        async function publish() {
            document.getElementById('status').textContent = '‚è≥ –ü—É–±–ª—ñ–∫—É—î–º–æ...';

            try {
                const response = await fetch('/api/publish', { method: 'POST' });
                const data = await response.json();

                if (data.success) {
                    document.getElementById('status').textContent = '‚úÖ –û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ! –ó–º—ñ–Ω–∏ –±—É–¥—É—Ç—å –Ω–∞ —Å–∞–π—Ç—ñ —á–µ—Ä–µ–∑ 2-3 —Ö–≤.';
                } else {
                    document.getElementById('status').textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞: ' + data.error;
                }
            } catch (error) {
                document.getElementById('status').textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message;
            }
        }
    </script>
</body>
</html>
```

**–°—Ç–≤–æ—Ä—ñ—Ç—å API endpoint:**

```bash
mkdir -p ~/projects/three-holy-hierarchs-church/src/pages/api
nano ~/projects/three-holy-hierarchs-church/src/pages/api/publish.ts
```

```typescript
import { exec } from 'child_process';
import { promisify } from 'util';

const execAsync = promisify(exec);

export async function POST() {
  try {
    const { stdout, stderr } = await execAsync(
      'cd /home/astro-app/projects/three-holy-hierarchs-church && /home/astro-app/scripts/auto-push-content.sh'
    );

    return new Response(JSON.stringify({
      success: true,
      message: stdout
    }), {
      status: 200,
      headers: { 'Content-Type': 'application/json' }
    });
  } catch (error) {
    return new Response(JSON.stringify({
      success: false,
      error: error.message
    }), {
      status: 500,
      headers: { 'Content-Type': 'application/json' }
    });
  }
}
```

**–î–æ—Å—Ç—É–ø:**
```
http://localhost:4321/admin/publish.html
```

---

## üîí –ë–µ–∑–ø–µ–∫–∞ {#–±–µ–∑–ø–µ–∫–∞}

### 1. –û–±–º–µ–∂–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É —á–µ—Ä–µ–∑ Teleport RBAC

**–£ Teleport —Å—Ç–≤–æ—Ä—ñ—Ç—å —Ä–æ–ª—å –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤:**

```yaml
kind: role
version: v5
metadata:
  name: keystatic-editors
spec:
  allow:
    app_labels:
      'env': 'production'
      'project': 'three-holy-hierarchs'
    logins:
      - astro-app
  deny: {}
```

**–ü—Ä–∏–∑–Ω–∞—á—Ç–µ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º:**
```bash
tctl create -f keystatic-editors-role.yaml
tctl users update user@example.com --set-roles=keystatic-editors
```

### 2. Firewall –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

```bash
# –î–æ–∑–≤–æ–ª–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ Teleport –∑'—î–¥–Ω–∞–Ω–Ω—è
sudo ufw allow from 10.0.0.0/8 to any port 4321 proto tcp

# –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –ø—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –∑–∑–æ–≤–Ω—ñ
sudo ufw deny 4321/tcp

# –£–≤—ñ–º–∫–Ω—É—Ç–∏ firewall
sudo ufw enable
```

### 3. –†–µ–≥—É–ª—è—Ä–Ω—ñ –±–µ–∫–∞–ø–∏

**–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±–µ–∫–∞–ø—ñ–≤:**

```bash
nano ~/scripts/backup-content.sh
```

```bash
#!/bin/bash

BACKUP_DIR="/home/astro-app/backups"
PROJECT_DIR="/home/astro-app/projects/three-holy-hierarchs-church"
DATE=$(date +%Y%m%d_%H%M%S)

# –°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –¥–ª—è –±–µ–∫–∞–ø—ñ–≤
mkdir -p "$BACKUP_DIR"

# –ó–∞–ø–∞–∫—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç
tar -czf "$BACKUP_DIR/content_$DATE.tar.gz" \
    -C "$PROJECT_DIR" \
    src/content/

# –í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –±–µ–∫–∞–ø–∏ (—Å—Ç–∞—Ä—à—ñ 30 –¥–Ω—ñ–≤)
find "$BACKUP_DIR" -name "content_*.tar.gz" -mtime +30 -delete

echo "[$(date)] –ë–µ–∫–∞–ø —Å—Ç–≤–æ—Ä–µ–Ω–æ: content_$DATE.tar.gz"
```

**–î–æ–¥–∞—Ç–∏ –≤ cron (—â–æ–¥–Ω—è –æ 2:00):**
```bash
crontab -e

0 2 * * * /home/astro-app/scripts/backup-content.sh >> /home/astro-app/logs/backup.log 2>&1
```

### 4. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥—ñ–≤

**–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ª–æ–≥—Ä–æ—Çate:**

```bash
sudo nano /etc/logrotate.d/keystatic
```

```
/home/astro-app/logs/*.log {
    daily
    missingok
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 astro-app astro-app
}
```

---

## üîß Troubleshooting {#troubleshooting}

### –ü—Ä–æ–±–ª–µ–º–∞ 1: PM2 –ø—Ä–æ—Ü–µ—Å –ø–∞–¥–∞—î

**–°–∏–º–ø—Ç–æ–º–∏:** `pm2 status` –ø–æ–∫–∞–∑—É—î `errored`

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è –ª–æ–≥–∏ –ø–æ–º–∏–ª–æ–∫
pm2 logs keystatic-cms --err

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
cd ~/projects/three-holy-hierarchs-church
npm install

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
pm2 restart keystatic-cms
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Teleport –Ω–µ –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è

**–°–∏–º–ø—Ç–æ–º–∏:** `connection refused` –∞–±–æ timeout

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞—Ü—é—î Astro
curl http://localhost:4321

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å Teleport
sudo systemctl status teleport

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ Teleport
sudo journalctl -u teleport -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Teleport
sudo systemctl restart teleport
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Git push –Ω–µ –ø—Ä–∞—Ü—é—î

**–°–∏–º–ø—Ç–æ–º–∏:** `Permission denied` –∞–±–æ `authentication failed`

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ SSH –∫–ª—é—á
ssh -T git@github.com

# –Ø–∫—â–æ –Ω–µ –ø—Ä–∞—Ü—é—î, –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä—É–π—Ç–µ –∫–ª—é—á
ssh-keygen -t ed25519 -C "server@company.com"
cat ~/.ssh/id_ed25519.pub
# –î–æ–¥–∞–π—Ç–µ —É GitHub Settings ‚Üí SSH Keys

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ remote URL
cd ~/projects/three-holy-hierarchs-church
git remote -v

# –Ø–∫—â–æ HTTPS, –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞ SSH
git remote set-url origin git@github.com:artemius-info/three-holy-hierarchs-church.git
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: Keystatic –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î –∑–º—ñ–Ω–∏

**–°–∏–º–ø—Ç–æ–º–∏:** –ö–Ω–æ–ø–∫–∞ Save –Ω–µ –ø—Ä–∞—Ü—é—î

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å
ls -la ~/projects/three-holy-hierarchs-church/src/content/

# –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –ø—Ä–∞–≤–∞
chmod -R 755 ~/projects/three-holy-hierarchs-church/src/content/

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ Keystatic –≤ local —Ä–µ–∂–∏–º—ñ
cat ~/projects/three-holy-hierarchs-church/keystatic.config.ts | grep storage
```

### –ü—Ä–æ–±–ª–µ–º–∞ 5: Vercel –Ω–µ –¥–µ–ø–ª–æ—ó—Ç—å –∑–º—ñ–Ω–∏

**–°–∏–º–ø—Ç–æ–º–∏:** –ü—É—à –ø—Ä–æ–π—à–æ–≤, –∞–ª–µ —Å–∞–π—Ç –Ω–µ –æ–Ω–æ–≤–∏–≤—Å—è

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ GitHub - —á–∏ —Ç–∞–º –∫–æ–º—ñ—Ç
# https://github.com/artemius-info/three-holy-hierarchs-church/commits/main

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Vercel Dashboard
# https://vercel.com/artemius-info/three-holy-hierarchs-church/deployments

# –Ø–∫—â–æ –¥–µ–ø–ª–æ–π –Ω–µ —Å—Ç–∞—Ä—Ç—É—î, —Ç—Ä–∏–≥–µ—Ä–Ω—É—Ç–∏ –≤—Ä—É—á–Ω—É
# –£ Vercel Dashboard ‚Üí Deployments ‚Üí Redeploy
```

---

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É —Å–∏—Å—Ç–µ–º–∏

**–°—Ç–≤–æ—Ä—ñ—Ç—å dashboard —Å–∫—Ä–∏–ø—Ç:**

```bash
nano ~/scripts/status.sh
```

```bash
#!/bin/bash

echo "========================================="
echo "Keystatic CMS Status Dashboard"
echo "========================================="
echo ""

# PM2 —Å—Ç–∞—Ç—É—Å
echo "üìä PM2 Processes:"
pm2 status keystatic-cms
echo ""

# Teleport —Å—Ç–∞—Ç—É—Å
echo "üîê Teleport Status:"
sudo systemctl is-active teleport
echo ""

# Git —Å—Ç–∞—Ç—É—Å
echo "üì¶ Git Status:"
cd ~/projects/three-holy-hierarchs-church
git status --short src/content/
echo ""

# –û—Å—Ç–∞–Ω–Ω—ñ–π –∫–æ–º—ñ—Ç
echo "üìù Last Commit:"
git log -1 --oneline
echo ""

# Disk usage
echo "üíæ Disk Usage:"
df -h /home/astro-app
echo ""

# Memory usage
echo "üß† Memory Usage:"
free -h
echo ""

echo "========================================="
```

**–ó—Ä–æ–±–∏—Ç–∏ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–º:**
```bash
chmod +x ~/scripts/status.sh
```

**–ó–∞–ø—É—Å—Ç–∏—Ç–∏:**
```bash
~/scripts/status.sh
```

---

## üìö –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

### PM2
```bash
pm2 start ecosystem.config.js    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏
pm2 stop keystatic-cms            # –ó—É–ø–∏–Ω–∏—Ç–∏
pm2 restart keystatic-cms         # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
pm2 logs keystatic-cms            # –î–∏–≤–∏—Ç–∏—Å—è –ª–æ–≥–∏
pm2 monit                         # –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
pm2 save                          # –ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
```

### Git
```bash
git status                        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–º—ñ–Ω–∏
git add src/content/              # –î–æ–¥–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç
git commit -m "Update content"    # –ó–∞–∫–æ–º—ñ—Ç–∏—Ç–∏
git push origin main              # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub
git pull origin main              # –û—Ç—Ä–∏–º–∞—Ç–∏ –∑–º—ñ–Ω–∏
```

### Teleport
```bash
tsh login                         # –ê–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—è
tsh app login keystatic-cms       # –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ app
tsh app open keystatic-cms        # –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
tsh ssh server                    # SSH –¥–æ—Å—Ç—É–ø
```

### Systemd
```bash
sudo systemctl status teleport    # –°—Ç–∞—Ç—É—Å
sudo systemctl restart teleport   # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo journalctl -u teleport -f    # –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
```

---

## üéâ –ì–æ—Ç–æ–≤–æ!

**–¢–µ–ø–µ—Ä —É –≤–∞—Å —î:**
- ‚úÖ Astro + Keystatic –Ω–∞ –æ—Ñ—ñ—Å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ
- ‚úÖ –ë–µ–∑–ø–µ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ Teleport
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ Vercel
- ‚úÖ –ë–µ–∫–∞–ø–∏ —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

**Workflow:**
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ Teleport
2. –†–µ–¥–∞–≥—É—î –∫–æ–Ω—Ç–µ–Ω—Ç —É Keystatic
3. –ó–º—ñ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—É—à–∞—Ç—å—Å—è –Ω–∞ GitHub (cron)
4. Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–µ–ø–ª–æ—ó—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
5. –°–∞–π—Ç –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∑–∞ 2-3 —Ö–≤–∏–ª–∏–Ω–∏

---

**–ü–∏—Ç–∞–Ω–Ω—è? –ü—Ä–æ–±–ª–µ–º–∏?** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–∑–¥—ñ–ª [Troubleshooting](#troubleshooting)

**–°—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è:** –•—Ä–∞–º –Ω–∞ —á–µ—Å—Ç—å –¢—Ä—å–æ—Ö —Å–≤—è—Ç–∏—Ç–µ–ª—ñ–≤ –Ω–∞ –ü–æ–¥–æ–ª—ñ
**–í–µ—Ä—Å—ñ—è:** 1.0
**–î–∞—Ç–∞:** 2026-02-03
